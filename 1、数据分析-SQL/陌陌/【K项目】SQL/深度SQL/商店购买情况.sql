select get_props_id as '购买道具ID', 
case get_props_id
when '101001' then '豌豆'  
when '101002' then '小麦'
when '101003' then '苜蓿'
when '101004' then '甘蔗'
when '101005' then '亚麻'
when '101006' then '蚕茧'
when '102001' then '土豆'
when '102002' then '蔓越莓'
when '102003' then '棉花'
when '102004' then '葡萄'
when '102005' then '西兰花'
when '102006' then '蓝玫瑰'
when '103001' then '石头'
when '103002' then '树枝'
when '103003' then '鲜花'
when '103004' then '蘑菇'
when '103005' then '普通原木'
when '103006' then '樱桃木'
when '103007' then '杉木'
when '103008' then '橡木'
when '103009' then '石英'
when '103010' then '魔晶'
when '103011' then '铁矿石'
when '103012' then '煤矿石'
when '103013' then '金矿石'
when '103014' then '宝石原石'
when '103015' then '蜂巢'
when '103016' then '神秘果'
when '103017' then '浆果'
when '103018' then '樱桃'
when '104001' then '水'
when '105001' then '月光'
when '105002' then '彩虹'
when '105003' then '智慧泉水'
when '105004' then '传动轴'
when '105005' then '扇叶'
when '105006' then '齿轮'
when '105007' then '角铁'
when '105008' then '木梁'
when '105009' then '瓦片'
when '105010' then '宁静之水'
when '105011' then '火球卷轴'
when '106001' then '鸡饲料'
when '106002' then '草垛'
when '106003' then '羊饲料'
when '106004' then '鹅饲料'
when '106005' then '猪饲料'
when '107001' then '鸡蛋'
when '107002' then '牛奶'
when '107003' then '羊毛'
when '107004' then '羊皮'
when '107005' then '鹅毛'
when '107006' then '鹅肉'
when '107007' then '松露'
when '108001' then '曲奇饼干'
when '108002' then '面包'
when '108003' then '马铃薯面包'
when '108004' then '蜜糖松饼'
when '108005' then '蔓越莓蛋糕'
when '108006' then '披萨'
when '109001' then '奶油'
when '109002' then '黄油'
when '109003' then '奶酪'
when '109004' then '酸奶'
when '110001' then '神奇蘑菇汤'
when '110002' then '浆果浆'
when '110003' then '烤土豆'
when '110004' then '神秘果浆'
when '110005' then '烤鹅'
when '110006' then '月之水'
when '110007' then '樱桃酱'
when '111001' then '石材'
when '111002' then '石英沙'
when '111003' then '宝石'
when '111004' then '黑曜石'
when '112001' then '木屑'
when '112002' then '普通木板'
when '112003' then '杉木板'
when '112004' then '橡木板'
when '112005' then '樱桃木板'
when '113001' then '甘蔗汁'
when '113002' then '亚麻油'
when '113003' then '蔓越莓汁'
when '113004' then '葡萄汁'
when '113005' then '蓝色诱惑'
when '113006' then '鲜花饮品'
when '114001' then '糖'
when '114002' then '蜂蜜'
when '114003' then '鲜花软糖'
when '114004' then '彩虹糖'
when '114005' then '牛轧糖'
when '115001' then '亚麻布'
when '115002' then '棉布'
when '115003' then '丝绸'
when '115004' then '毛线'
when '116001' then '麻衣'
when '116002' then '背包'
when '116003' then '晚礼服'
when '116004' then '桌布'
when '116005' then '披风'
when '116006' then '被子'
when '116007' then '帽子'
when '116008' then '长袍'
when '117001' then '铁丝'
when '117002' then '铁管'
when '117003' then '铁板'
when '117004' then '金块'
when '117005' then '玻璃'
when '118001' then '椅子'
when '118002' then '桌子'
when '118003' then '架子'
when '118004' then '床'
when '118005' then '梯子'
when '118006' then '豪华木盒'
when '119001' then '魔杖'
when '119002' then '羽毛笔'
when '119003' then '幸运马蹄铁'
when '119004' then '护身符'
when '119005' then '魔法卫兵'
when '120001' then '薯条'
when '120002' then '土豆泥'
when '120003' then '西兰花沙拉'
when '120004' then '蘑菇炒蛋'
when '120005' then '松露面'
when '121001' then '魔力药剂'
when '121002' then '生命树枝'
when '121003' then '活性金属'
when '121004' then '魔法油彩'
when '122001' then '咆哮信纸'
when '122002' then '羊皮纸'
when '122003' then '冒险指南'
when '122004' then '地图'
when '123001' then '猎人号角'
when '123002' then '旅人风笛'
when '123003' then '月色管风琴'
when '123004' then '治愈的竖琴'
when '123005' then '定音鼓'
when '124001' then '仪轨'
when '124002' then '水晶瓶'
when '124003' then '士兵雕塑'
when '124004' then '神秘墨水'
when '124005' then '油画'
when '124006' then '金酒杯'
when '125001' then '水晶球'
when '125002' then '塔罗牌'
when '125003' then '魔法卷轴'
when '125004' then '魔法袍'
when '125005' then '魔法书'
when '126001' then '鸡'
when '126002' then '岩石鸡'
when '126003' then '牛'
when '126004' then '高地牛'
when '126005' then '羊'
when '126006' then '黑面羊'
when '126007' then '鹅'
when '126008' then '灰鹅'
when '126009' then '猪'
when '126010' then '纯种猪'
when '127001' then '耕地'
when '127002' then '肥沃耕地'
when '127003' then '温室'
when '127004' then '暖屋'
when '127005' then '小体力回复'
when '127006' then '中体力回复'
when '127007' then '大体力回复'
when '127008' then '炸弹1'
when '127009' then '炸弹2'
when '127010' then '炸弹3'
when '127011' then '雨伞菇'
when '127012' then '双生花'
when '127013' then '魔豆'
when '127014' then '血月果'
when '127015' then '金苹果'
when '127016' then '牲畜币-铜币'
when '127017' then '牲畜币-银币'
when '127018' then '牲畜币-钻石币'
when '127019' then '瞬时肥料'
when '127020' then '沙漏'
when '127021' then '干冰'
when '127022' then '优惠券'
when '127023' then '航海望远镜'
when '127024' then '金币'
when '127025' then '绿宝石'
when '127026' then '体力'
when '127027' then '经验'
when '127028' then '炸弹'
when '127029' then '体力15'
when '127030' then '体力5'
when '127031' then '雇佣券'
when '127032' then '绿宝石1'
when '127033' then '绿宝石2'
when '127034' then '绿宝石3'
when '127035' then '绿宝石4'
when '127036' then '绿宝石5'
when '127037' then '绿宝石6'
when '128001' then '蓝晶石'
when '128002' then '紫晶石'
when '128003' then '红晶石'
when '128004' then '黄晶石'
when '128005' then '橙晶石'
when '128006' then '龟壳石'
when '128007' then '欧泊石'
when '128008' then '月亮石'
when '128009' then '七彩石'
when '128010' then '星云石'
when '129001' then '盐窑'
when '129002' then '酒杯'
when '129003' then '托盘'
when '129004' then '刀叉'
when '129005' then '茶具'
when '129006' then '椰子奏鸣曲'
when '129007' then '菠萝风暴'
when '129008' then '西瓜微风'
when '129009' then '蜜瓜交响曲'
when '129010' then '花瓣协奏曲'
when '129011' then '大灰狼套装'
when '129012' then '小矮人套装'
when '129013' then '圣诞老人套装'
when '129014' then '长鼻子面具'
when '129015' then '狐狸面具'
when '129016' then '蓝宝石'
when '129017' then '祖母绿'
when '129018' then '琥珀'
when '129019' then '红宝石'
when '129020' then '猫眼石'
when '129021' then '海螺'
when '129022' then '珍珠贝壳'
when '129023' then '鹦鹉螺'
when '129024' then '绮蛳螺'
when '129025' then '凤凰螺'
when '129026' then '海洋之心'
when '129027' then '珍珠泪皇冠'
when '129028' then '猎豹胸针'
when '129029' then '黑王子王冠'
when '129030' then '凯尔特人手镯'
when '129031' then '肉桂'
when '129032' then '迷迭香'
when '129033' then '番红花'
when '129034' then '多香果'
when '129035' then '罗勒'
when '129036' then '胡桃夹子'
when '129037' then '套娃'
when '129038' then '和服娃娃'
when '129039' then '提线木偶'
when '129040' then '编织娃娃'
when '141001' then '生命结晶'
when '141002' then '海洋结晶'
when '141003' then '大地结晶'
when '141004' then '晶钻'
when '141005' then '生命之叶'
when '141006' then '生命药剂'
when '141007' then '海星'
when '141008' then '魔力玫瑰'
when '141009' then '幸运树枝'
when '141010' then '精灵之木'
when '141011' then '妮莫的工具箱'
when '141012' then '科林的木板'
when '141013' then '安德鲁的栗子'
when '142001' then '海底海螺'
when '142002' then '珍珠'
when '142003' then '红珊瑚'
when '142004' then '蓝珊瑚'
when '142005' then '绿珊瑚'
when '142006' then '黄珊瑚'
when '142007' then '海葵'
when '142008' then '贝壳1'
when '142009' then '热带花'
when '142010' then '荧光海砂'
when '142011' then '荧光珍珠'
when '142012' then '旧礼帽'
when '142013' then '放大帽'
when '142014' then '绸带'
when '142015' then '航海罗盘'
when '142016' then '神奇罗盘'
when '142017' then '淡水'
when '142018' then '变形药剂'
when '142019' then '驯化魔杖'
when '142020' then '冬青木'
when '142021' then '龙角'
when '142022' then '木蜡油'
when '142023' then '符文石'
when '142024' then '鲑鱼'
when '142025' then '钓竿'
when '142026' then '鱼饵'
when '142027' then '魔泉水'
when '142028' then '海蓝石'
when '142029' then '菠萝'
when '142030' then '菠萝鸡尾酒'
when '142031' then '椰子'
when '142032' then '椰子布丁'
when '142033' then '香蕉'
when '142034' then '焦糖香蕉排'
when '142035' then '蓝香草'
when '142036' then '遗迹钥匙'
when '142037' then '幻想之花'
when '142038' then '月光海星'
when '142039' then '七色海葵'
when '142040' then '智慧海螺'
when '142041' then '复原核心'
when '142042' then '漂浮包裹'
when '142043' then '贝壳2'
when '142044' then '贝壳3'
when '142045' then '贝壳4'
when '142046' then '贝壳4'
when '142047' then '菊花'
when '142048' then '松果菊'
when '142049' then '藏红花'
when '142050' then '生肋排'
when '142051' then '烤肋排'
when '142052' then '橙子'
when '142053' then '橙汁'
when '142054' then '甜菜'
when '142055' then '棒棒糖'
when '142056' then '橙汁（恢复体力）'
when '142057' then '烤肋排（恢复体力）'
when '142058' then '棒棒糖（恢复体力）'
when '142059' then '秋季花茶（恢复体力）'
when '142060' then '美食餐桌'
when '142061' then '鱼排'
when '142062' then '珊瑚茶'
when '142063' then '玫红石'
when '142064' then '沙黄石'
when '142066' then '冰'
when '142067' then '航海地图'
when '142068' then '月牙森林的蚕茧'
when '143001' then '修桥工具'
when '143002' then '哈斯曼夫人的信'
when '143003' then '冻苹果'
when '143004' then '冰葡萄'
when '143005' then '紫薯'
when '143006' then '苹果酱'
when '143007' then '葡萄派'
when '143008' then '烤紫薯'
when '143009' then '魔法晶粉'
when '143010' then '冰蘑菇'
when '143011' then '奶油蘑菇汤'
when '143012' then '胡萝卜'
when '143013' then '记忆宝珠'
when '143014' then '魔盒'
when '143015' then '哈斯曼特制苹果酱'
when '143016' then '冰玫瑰'
when '143017' then '冬季鱼饵'
when '143018' then '熊毛'
when '143019' then '莫甘娜的留言条'
when '143020' then '冬季钓竿'
when '200001' then '耕地'
when '200002' then '秋千'
when '200003' then '岩石鸡'
when '200004' then '宝石放置台（宝箱）'
end as '购买道具名称', 
sum(get_props_count) as '购买道具数量', 
round(sum(get_props_count)/count(distinct user_id),2) as '账户平均购买道具数量',
sum(case when consume_currency_id = '2' then consume_currency_count else 0 end) as '消耗钻石数量', 
round(sum(case when consume_currency_id = '2' then consume_currency_count else 0 end)/count(distinct user_id),2) as '账户平均消耗钻石数量',
round(sum(case when consume_currency_id = '2' then consume_currency_count else 0 end)/sum(get_props_count),2) as '道具平均消耗钻石数量',
count(distinct user_id) as '购买该道具账户数'
from fairy_town_server.server_on_shop_buy
where 
day_time between ${beginDate} and ${endDate}
      and server_id in (${serverIds})
group by get_props_id
order by 消耗钻石数量 desc;