select a.package_id as '礼包ID',
case a.package_id
when '1' then '新手礼包'
when '2' then '刺激多次付费礼包-0.99（优惠400%）'
when '3' then '刺激多次付费礼包-1.99（优惠150%）'
when '4' then '刺激多次付费礼包-3.99（优惠65%）'
when '5' then '刺激多次付费礼包-9.99（优惠55%）'
when '6' then '刺激多次付费礼包-19.99（优惠40%）'
when '7' then '刺激多次付费礼包-39.99（优惠30%）'
when '8' then '刺激多次付费礼包-69.99（优惠25%）'
when '9' then '刺激多次付费礼包-0.99（优惠400%）'
when '10' then '刺激多次付费礼包-1.99（优惠150%）'
when '11' then '刺激多次付费礼包-3.99（优惠65%）'
when '12' then '刺激多次付费礼包-9.99（优惠55%）'
when '13' then '刺激多次付费礼包-19.99（优惠40%）'
when '14' then '刺激多次付费礼包-39.99（优惠30%）'
when '15' then '刺激多次付费礼包-69.99（优惠25%）'
when '16' then '刺激多次付费礼包-0.99（优惠400%）'
when '17' then '刺激多次付费礼包-1.99（优惠150%）'
when '18' then '刺激多次付费礼包-3.99（优惠65%）'
when '19' then '刺激多次付费礼包-9.99（优惠55%）'
when '20' then '刺激多次付费礼包-19.99（优惠40%）'
when '21' then '刺激多次付费礼包-39.99（优惠30%）'
when '22' then '刺激多次付费礼包-69.99（优惠25%）'
when '23' then '刺激多次付费礼包-0.99（优惠400%）'
when '24' then '刺激多次付费礼包-1.99（优惠150%）'
when '25' then '刺激多次付费礼包-3.99（优惠65%）'
when '26' then '刺激多次付费礼包-9.99（优惠55%）'
when '27' then '刺激多次付费礼包-19.99（优惠40%）'
when '28' then '刺激多次付费礼包-39.99（优惠30%）'
when '29' then '刺激多次付费礼包-69.99（优惠25%）'
when '30' then '刺激多次付费礼包-0.99（优惠400%）'
when '31' then '刺激多次付费礼包-1.99（优惠150%）'
when '32' then '刺激多次付费礼包-3.99（优惠65%）'
when '33' then '刺激多次付费礼包-9.99（优惠55%）'
when '34' then '刺激多次付费礼包-19.99（优惠40%）'
when '35' then '刺激多次付费礼包-39.99（优惠30%）'
when '36' then '刺激多次付费礼包-69.99（优惠25%）'
when '37' then '刺激多次付费礼包-0.99（优惠400%）'
when '38' then '刺激多次付费礼包-1.99（优惠150%）'
when '39' then '刺激多次付费礼包-3.99（优惠65%）'
when '40' then '刺激多次付费礼包-9.99（优惠55%）'
when '41' then '刺激多次付费礼包-19.99（优惠40%）'
when '42' then '刺激多次付费礼包-39.99（优惠30%）'
when '43' then '刺激多次付费礼包-69.99（优惠25%）'
when '44' then '刺激多次付费礼包-0.99（优惠400%）'
when '45' then '刺激多次付费礼包-1.99（优惠150%）'
when '46' then '刺激多次付费礼包-3.99（优惠65%）'
when '47' then '刺激多次付费礼包-9.99（优惠55%）'
when '48' then '刺激多次付费礼包-19.99（优惠40%）'
when '49' then '刺激多次付费礼包-39.99（优惠30%）'
when '50' then '刺激多次付费礼包-69.99（优惠25%）'
when '51' then '刺激多次付费礼包-0.99（优惠400%）'
when '52' then '刺激多次付费礼包-1.99（优惠150%）'
when '53' then '刺激多次付费礼包-3.99（优惠65%）'
when '54' then '刺激多次付费礼包-9.99（优惠55%）'
when '55' then '刺激多次付费礼包-19.99（优惠40%）'
when '56' then '刺激多次付费礼包-39.99（优惠30%）'
when '57' then '刺激多次付费礼包-69.99（优惠25%）'
when '58' then '刺激多次付费礼包-0.99（优惠400%）'
when '59' then '刺激多次付费礼包-1.99（优惠150%）'
when '60' then '刺激多次付费礼包-3.99（优惠65%）'
when '61' then '刺激多次付费礼包-9.99（优惠55%）'
when '62' then '刺激多次付费礼包-19.99（优惠40%）'
when '63' then '刺激多次付费礼包-39.99（优惠30%）'
when '64' then '刺激多次付费礼包-69.99（优惠25%）'
when '65' then '刺激多次付费礼包-0.99（优惠400%）'
when '66' then '刺激多次付费礼包-1.99（优惠150%）'
when '67' then '刺激多次付费礼包-3.99（优惠65%）'
when '68' then '刺激多次付费礼包-9.99（优惠55%）'
when '69' then '刺激多次付费礼包-19.99（优惠40%）'
when '70' then '刺激多次付费礼包-39.99（优惠30%）'
when '71' then '刺激多次付费礼包-69.99（优惠25%）'
when '72' then '刺激多次付费礼包-0.99（优惠400%）'
when '73' then '刺激多次付费礼包-1.99（优惠150%）'
when '74' then '刺激多次付费礼包-3.99（优惠65%）'
when '75' then '刺激多次付费礼包-9.99（优惠55%）'
when '76' then '刺激多次付费礼包-19.99（优惠40%）'
when '77' then '刺激多次付费礼包-39.99（优惠30%）'
when '78' then '刺激多次付费礼包-69.99（优惠25%）'
when '79' then '刺激多次付费礼包-0.99（优惠400%）'
when '80' then '刺激多次付费礼包-1.99（优惠150%）'
when '81' then '刺激多次付费礼包-3.99（优惠65%）'
when '82' then '刺激多次付费礼包-9.99（优惠55%）'
when '83' then '刺激多次付费礼包-19.99（优惠40%）'
when '84' then '刺激多次付费礼包-39.99（优惠30%）'
when '85' then '刺激多次付费礼包-69.99（优惠25%）'
when '86' then '刺激多次付费礼包-0.99（优惠400%）'
when '87' then '刺激多次付费礼包-1.99（优惠150%）'
when '88' then '刺激多次付费礼包-3.99（优惠65%）'
when '89' then '刺激多次付费礼包-9.99（优惠55%）'
when '90' then '刺激多次付费礼包-19.99（优惠40%）'
when '91' then '刺激多次付费礼包-39.99（优惠30%）'
when '92' then '刺激多次付费礼包-69.99（优惠25%）'
when '93' then '停止付费用户再付费礼包-1.99（优惠180%）'
when '94' then '停止付费用户再付费礼包-2.99（优惠95%）'
when '95' then '停止付费用户再付费礼包-7.99（优惠65%）'
when '96' then '停止付费用户再付费礼包-14.99（优惠50%）'
when '97' then '停止付费用户再付费礼包-30.99（优惠35%）'
when '98' then '停止付费用户再付费礼包-54.99（优惠30%）'
when '99' then '停止付费用户再付费礼包-1.99（优惠180%）'
when '100' then '停止付费用户再付费礼包-2.99（优惠95%）'
when '101' then '停止付费用户再付费礼包-7.99（优惠65%）'
when '102' then '停止付费用户再付费礼包-14.99（优惠50%）'
when '103' then '停止付费用户再付费礼包-30.99（优惠35%）'
when '104' then '停止付费用户再付费礼包-54.99（优惠30%）'
when '105' then '停止付费用户再付费礼包-1.99（优惠180%）'
when '106' then '停止付费用户再付费礼包-2.99（优惠95%）'
when '107' then '停止付费用户再付费礼包-7.99（优惠65%）'
when '108' then '停止付费用户再付费礼包-14.99（优惠50%）'
when '109' then '停止付费用户再付费礼包-30.99（优惠35%）'
when '110' then '停止付费用户再付费礼包-54.99（优惠30%）'
when '111' then '停止付费用户再付费礼包-1.99（优惠180%）'
when '112' then '停止付费用户再付费礼包-2.99（优惠95%）'
when '113' then '停止付费用户再付费礼包-7.99（优惠65%）'
when '114' then '停止付费用户再付费礼包-14.99（优惠50%）'
when '115' then '停止付费用户再付费礼包-30.99（优惠35%）'
when '116' then '停止付费用户再付费礼包-54.99（优惠30%）'
when '117' then '停止付费用户再付费礼包-1.99（优惠180%）'
when '118' then '停止付费用户再付费礼包-2.99（优惠95%）'
when '119' then '停止付费用户再付费礼包-7.99（优惠65%）'
when '120' then '停止付费用户再付费礼包-14.99（优惠50%）'
when '121' then '停止付费用户再付费礼包-30.99（优惠35%）'
when '122' then '停止付费用户再付费礼包-54.99（优惠30%）'
when '123' then '停止付费用户再付费礼包-1.99（优惠180%）'
when '124' then '停止付费用户再付费礼包-2.99（优惠95%）'
when '125' then '停止付费用户再付费礼包-7.99（优惠65%）'
when '126' then '停止付费用户再付费礼包-14.99（优惠50%）'
when '127' then '停止付费用户再付费礼包-30.99（优惠35%）'
when '128' then '停止付费用户再付费礼包-54.99（优惠30%）'
when '129' then '停止付费用户再付费礼包-1.99（优惠180%）'
when '130' then '停止付费用户再付费礼包-2.99（优惠95%）'
when '131' then '停止付费用户再付费礼包-7.99（优惠65%）'
when '132' then '停止付费用户再付费礼包-14.99（优惠50%）'
when '133' then '停止付费用户再付费礼包-30.99（优惠35%）'
when '134' then '停止付费用户再付费礼包-54.99（优惠30%）'
when '135' then '停止付费用户再付费礼包-1.99（优惠180%）'
when '136' then '停止付费用户再付费礼包-2.99（优惠95%）'
when '137' then '停止付费用户再付费礼包-7.99（优惠65%）'
when '138' then '停止付费用户再付费礼包-14.99（优惠50%）'
when '139' then '停止付费用户再付费礼包-30.99（优惠35%）'
when '140' then '停止付费用户再付费礼包-54.99（优惠30%）'
when '141' then '停止付费用户再刺激礼包-0.99（优惠400%）'
when '142' then '停止付费用户再刺激礼包-1.99（优惠200%）'
when '143' then '停止付费用户再刺激礼包-6.99（优惠75%）'
when '144' then '停止付费用户再刺激礼包-12.99（优惠60%）'
when '145' then '停止付费用户再刺激礼包-26.99（优惠45%）'
when '146' then '停止付费用户再刺激礼包-45.99（优惠45%）'
when '147' then '停止付费用户再刺激礼包-0.99（优惠400%）'
when '148' then '停止付费用户再刺激礼包-1.99（优惠200%）'
when '149' then '停止付费用户再刺激礼包-6.99（优惠75%）'
when '150' then '停止付费用户再刺激礼包-12.99（优惠60%）'
when '151' then '停止付费用户再刺激礼包-26.99（优惠45%）'
when '152' then '停止付费用户再刺激礼包-45.99（优惠45%）'
when '153' then '停止付费用户再刺激礼包-0.99（优惠400%）'
when '154' then '停止付费用户再刺激礼包-1.99（优惠200%）'
when '155' then '停止付费用户再刺激礼包-6.99（优惠75%）'
when '156' then '停止付费用户再刺激礼包-12.99（优惠60%）'
when '157' then '停止付费用户再刺激礼包-26.99（优惠45%）'
when '158' then '停止付费用户再刺激礼包-45.99（优惠45%）'
when '159' then '停止付费用户再刺激礼包-0.99（优惠400%）'
when '160' then '停止付费用户再刺激礼包-1.99（优惠200%）'
when '161' then '停止付费用户再刺激礼包-6.99（优惠75%）'
when '162' then '停止付费用户再刺激礼包-12.99（优惠60%）'
when '163' then '停止付费用户再刺激礼包-26.99（优惠45%）'
when '164' then '停止付费用户再刺激礼包-45.99（优惠45%）'
when '165' then '停止付费用户再刺激礼包-0.99（优惠400%）'
when '166' then '停止付费用户再刺激礼包-1.99（优惠200%）'
when '167' then '停止付费用户再刺激礼包-6.99（优惠75%）'
when '168' then '停止付费用户再刺激礼包-12.99（优惠60%）'
when '169' then '停止付费用户再刺激礼包-26.99（优惠45%）'
when '170' then '停止付费用户再刺激礼包-45.99（优惠45%）'
when '171' then '宝石援助礼包-0.99-400%'
when '172' then '宝石援助礼包-1.99-150%'
when '173' then '宝石援助礼包-3.99-65%'
when '174' then '宝石援助礼包-9.99-55%'
when '175' then '宝石援助礼包-19.99-40%'
when '176' then '宝石援助礼包-39.99-30%'
when '177' then '宝石援助礼包-69.99-25%'
end as '礼包名称',
商品ID,
case 商品ID
when '704011' then '新手优惠'  
when '704012' then '刺激多次付费礼包-0.99（优惠400%）'
when '704013' then '刺激多次付费礼包-1.99（优惠150%）'
when '704014' then '刺激多次付费礼包-3.99（优惠65%）'
when '704015' then '刺激多次付费礼包-9.99（优惠55%）'
when '704016' then '刺激多次付费礼包-19.99（优惠40%）'
when '704017' then '刺激多次付费礼包-39.99（优惠30%）'
when '704018' then '刺激多次付费礼包-69.99（优惠25%）'
when '704019' then '刺激多次付费礼包-99.99（优惠15%）'
when '704020' then '停止付费用户再付费礼包-1.99（优惠180%）'
when '704021' then '停止付费用户再付费礼包-2.99（优惠95%）'
when '704022' then '停止付费用户再付费礼包-7.99（优惠65%）'
when '704023' then '停止付费用户再付费礼包-14.99（优惠50%）'
when '704024' then '停止付费用户再付费礼包-30.99（优惠35%）'
when '704025' then '停止付费用户再付费礼包-54.99（优惠30%）'
when '704026' then '停止付费用户再付费礼包-84.99（优惠20%）'
when '704027' then '停止付费用户再刺激礼包-1.99（优惠200%）'
when '704028' then '停止付费用户再刺激礼包-6.99（优惠75%）'
when '704029' then '停止付费用户再刺激礼包-12.99（优惠60%）'
when '704030' then '停止付费用户再刺激礼包-26.99（优惠45%）'
when '704031' then '停止付费用户再刺激礼包-45.99（优惠45%）'
when '704032' then '停止付费用户再刺激礼包-59.99（优惠25%）'
when '704033' then '宝石援助礼包-0.99-400%'
when '704034' then '宝石援助礼包-1.99-150%'
when '704035' then '宝石援助礼包-3.99-65%'
when '704036' then '宝石援助礼包-9.99-55%'
when '704037' then '宝石援助礼包-19.99-40%'
when '704038' then '宝石援助礼包-39.99-30%'
when '704039' then '宝石援助礼包-69.99-25%'
end as '商品名称',
触发账号数,触发次数,购买账号数,购买次数,充值金额,
round(购买次数/触发次数*100,2) as '购买/触发次数比例%',
round(购买账号数/触发账号数*100,2) as '购买/触发账户比例%'
from 
(
SELECT package_id, count(distinct user_id) as '触发账号数', count(1) as '触发次数'
from fairy_town_server.server_package_on_sale
where day_time between ${beginDate} and ${endDate} and server_id in (${serverIds})
group by package_id
)a
left join 
(
select package_id, award_id as '商品ID', 
count(distinct user_id) as '购买账号数', count(1) as '购买次数',
sum(cast(consume_currency_count as decimal(9,2)))as '充值金额'
from fairy_town_server.server_package_delivered
where day_time between ${beginDate} and ${endDate} and server_id in (${serverIds})
group by package_id, award_id
)b
on a.package_id=b.package_id
order by 充值金额 desc